rule m20_urausy_skype_dat {
    meta:
        title          = "Malware. Urausy Skype"
        author         = "AlienVault Labs"
        source         = "https://github.com/AlienVault-Labs/AlienVaultLabs/blob/347a57b31829b6f8e3280e0fd6a0ed49e5453c67/malware_analysis/Urausy/urausy_skypedat.yar"
        description    = "Yara rule to match against memory of processes infected by Urausy skype.dat"
        created_date   = "2013-06-12"
        reference      = "https://www.iso.org/standard/54796.html"
    strings:
        $a = "skype.dat" ascii wide
        $b = "skype.ini" ascii wide
        $win1 = "CreateWindow"
        $win2 = "YIWEFHIWQ" ascii wide
        $desk1 = "CreateDesktop"
        $desk2 = "MyDesktop" ascii wide
    condition:
        $a and $b and (all of ($win*) or all of ($desk*))
}
// --
rule m21_Careto {
    meta:
        title          = "Malware. Careto malware signature"
        author         = "AlienVault (Alberto Ortega)"
        source         = "https://github.com/AlienVault-Labs/AlienVaultLabs/blob/347a57b31829b6f8e3280e0fd6a0ed49e5453c67/malware_analysis/TheMask_Careto/mask.yar"
        description    = "TheMask / Careto generic malware signature"
        created_date   = "2014-02-19"
        reference      = "www.securelist.com/en/downloads/vlpdfs/unveilingthemask_v1.0.pdf"
    strings:

        /* General */
        $name1 = "Careto" ascii wide
        $s_1 = "GetSystemReport" ascii wide
        $s_2 = "SystemReport.txt" ascii wide
        $s_3 = /URL_AUX\w*=/ ascii wide
        $s_4 = /CaretoPruebas.{1,N}release/

        /* Certificate */
        $sign_0 = "Sofia"
        $sign_1 = "TecSystem Ltd"
        $sign_2 = "<<<Obsolete>>>" wide

        /* Encryption keys */
        $rc4_1 = "!$7be&.Kaw-12[}" ascii wide
        $rc4_2 = "Caguen1aMar" ascii wide
        /* http://laboratorio.blogs.hispasec.com/2014/02/analisis-del-algoritmo-de-descifrado.html */
        $rc4_3 = {8d 85 86 8a 8f 80 88 83 8d 82 88 85 86 8f 8f 87 8d 82 83 82 8c 8e 83 8d 89 82 86 87 82 83 83 81}

        /* Decryption routine fragment */
        $dec_1 = {8b 4d 08 0f be 04 59 0f be 4c 59 01 2b c7 c1 e0 04 2b cf 0b c1 50 8d 85 f0 fe ff ff}
        $dec_2 = {8b 4d f8 8b 16 88 04 11 8b 06 41 89 4d f8 c6 04 01 00 43 3b 5d fc}

    condition:
        $name1 and (any of ($s_*)) or all of ($sign_*) or any of ($rc4_*) or all of ($dec_*)
}
// --
rule m22_Careto_SGH {
    meta:
        title          = "Malware. Careto SGH component signature"
        author         = "AlienVault (Alberto Ortega)"
        source         = "https://github.com/AlienVault-Labs/AlienVaultLabs/blob/347a57b31829b6f8e3280e0fd6a0ed49e5453c67/malware_analysis/TheMask_Careto/mask.yar"
        description    = "TheMask / Careto SGH component signature"
        created_date   = "2014-02-19"
        reference      = "www.securelist.com/en/downloads/vlpdfs/unveilingthemask_v1.0.pdf"
    strings:
        $m1 = "PGPsdkDriver" ascii wide fullword
        $m2 = "jpeg1x32" ascii wide fullword
        $m3 = "SkypeIE6Plugin" ascii wide fullword
        $m4 = "CDllUninstall" ascii wide fullword
    condition:
        2 of them
}
// --
rule m23_Careto_OSX_SBD {
    meta:
        title          = "Malware. Careto OSX CnC"
        author         = "AlienVault (Alberto Ortega)"
        source         = "https://github.com/AlienVault-Labs/AlienVaultLabs/blob/347a57b31829b6f8e3280e0fd6a0ed49e5453c67/malware_analysis/TheMask_Careto/mask.yar"
        description    = "TheMask / Careto OSX component signature"
        created_date   = "2014-02-19"
        reference      = "www.securelist.com/en/downloads/vlpdfs/unveilingthemask_v1.0.pdf"
    strings:
        /* XORed "/dev/null strdup() setuid(geteuid())" */
        $1 = {FF 16 64 0A 7E 1A 63 4D 21 4D 3E 1E 60 0F 7C 1A 65 0F 74 0B 3E 1C 7F 12}
    condition:
        all of them
}
// --
rule m24_Careto_CnC {
    meta:
        title          = "Malware. Careto CnC signature"
        author         = "AlienVault (Alberto Ortega)"
        source         = "https://github.com/AlienVault-Labs/AlienVaultLabs/blob/347a57b31829b6f8e3280e0fd6a0ed49e5453c67/malware_analysis/TheMask_Careto/mask.yar"
        description    = "TheMask / Careto CnC communication signature"
        created_date   = "2014-02-19"
        reference      = "www.securelist.com/en/downloads/vlpdfs/unveilingthemask_v1.0.pdf"
    strings:
        $1 = "cgi-bin/commcgi.cgi" ascii wide
        $2 = "Group" ascii wide
        $3 = "Install" ascii wide
        $4 = "Bn" ascii wide
    condition:
        all of them
}
// --
rule m25_Careto_CnC_domains {
    meta:
        title          = "Malware. Careto CnC signature domain"
        author         = "AlienVault (Alberto Ortega)"
        source         = "https://github.com/AlienVault-Labs/AlienVaultLabs/blob/347a57b31829b6f8e3280e0fd6a0ed49e5453c67/malware_analysis/TheMask_Careto/mask.yar"
        description    = "TheMask / Careto known command and control domains"
        created_date   = "2014-02-19"
        reference      = "www.securelist.com/en/downloads/vlpdfs/unveilingthemask_v1.0.pdf"
    strings:
        $1 = "linkconf.net" ascii wide nocase
        $2 = "redirserver.net" ascii wide nocase
        $3 = "swupdt.com" ascii wide nocase
    condition:
        any of them
}
// --
rule m26_Mirai_Botnet_Malware {
    meta:
        title          = "Malware. Mirai Botnet Malware"
        author         = "Florian Roth"
        source         = "https://github.com/Neo23x0/signature-base/blob/d18931092ab97473ae477366ff9ae41107c4ac29/yara/crime_mirai.yar"
        description    = "Detects Mirai Botnet Malware"
        created_date   = "2016-10-04"
        reference      = "Internal Research"
        license        = "Detection Rule https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
        hash1 = "05c78c3052b390435e53a87e3d31e9fb17f7c76bb4df2814313bca24735ce81c"
        hash2 = "05c78c3052b390435e53a87e3d31e9fb17f7c76bb4df2814313bca24735ce81c"
        hash3 = "20683ff7a5fec1237fc09224af40be029b9548c62c693844624089af568c89d4"
        hash4 = "2efa09c124f277be2199bee58f49fc0ce6c64c0bef30079dfb3d94a6de492a69"
        hash5 = "420bf9215dfb04e5008c5e522eee9946599e2b323b17f17919cd802ebb012175"
        hash6 = "62cdc8b7fffbaf5683a466f6503c03e68a15413a90f6afd5a13ba027631460c6"
        hash7 = "70bb0ec35dd9afcfd52ec4e1d920e7045dc51dca0573cd4c753987c9d79405c0"
        hash8 = "89570ae59462e6472b6769545a999bde8457e47ae0d385caaa3499ab735b8147"
        hash9 = "bf0471b37dba7939524a30d7d5afc8fcfb8d4a7c9954343196737e72ea4e2dc4"
        hash10 = "c61bf95146c68bfbbe01d7695337ed0e93ea759f59f651799f07eecdb339f83f"
        hash11 = "d9573c3850e2ae35f371dff977fc3e5282a5e67db8e3274fd7818e8273fd5c89"
        hash12 = "f1100c84abff05e0501e77781160d9815628e7fd2de9e53f5454dbcac7c84ca5"
        hash13 = "fb713ccf839362bf0fbe01aedd6796f4d74521b133011b408e42c1fd9ab8246b"
    strings:
        $x1 = "POST /cdn-cgi/" fullword ascii
        $x2 = "/dev/misc/watchdog" fullword ascii
        $x3 = "/dev/watchdog" ascii
        $x4 = "\\POST /cdn-cgi/" fullword ascii
        $x5 = ".mdebug.abi32" fullword ascii

        $s1 = "LCOGQGPTGP" fullword ascii
        $s2 = "QUKLEKLUKVJOG" fullword ascii
        $s3 = "CFOKLKQVPCVMP" fullword ascii
        $s4 = "QWRGPTKQMP" fullword ascii
        $s5 = "HWCLVGAJ" fullword ascii
        $s6 = "NKQVGLKLE" fullword ascii
    condition:
        uint16(0) == 0x457f and filesize < 200KB and
        (
            ( 1 of ($x*) and 1 of ($s*) ) or
            4 of ($s*)
        )
}
// --
rule m27_Mirai_1_May17 {
   meta:
      title          = "Malware. Mirai Botnet"
      author         = "Florian Roth"
      source         = "https://github.com/Neo23x0/signature-base/blob/d18931092ab97473ae477366ff9ae41107c4ac29/yara/crime_mirai.yar"
      description    = "Detects Mirai Botnet Malware"
      created_date   = "2017-05-12"
      reference      = "Internal Research"
      license        = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
      super_rule     = 1
      hash1 = "172d050cf0d4e4f5407469998857b51261c80209d9fa5a2f5f037f8ca14e85d2"
      hash2 = "9ba8def84a0bf14f682b3751b8f7a453da2cea47099734a72859028155b2d39c"
      hash3 = "a393449a5f19109160384b13d60bb40601af2ef5f08839b5223f020f1f83e990"
   strings:
      $s1 = "GET /bins/mirai.x86 HTTP/1.0" fullword ascii
   condition:
      ( uint16(0) == 0x457f and filesize < 5000KB and all of them )
}
// --
rule m28_Miari_2_May17 {
   meta:
      title            = "Malware. Mirai"
      author           = "Florian Roth"
      source           = "https://github.com/Neo23x0/signature-base"
      description      = "Detects Mirai Malware"
      created_date     = "2017-05-12"
      reference        = "Internal Research"
      license          = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
      super_rule       = 1
      hash1 = "9ba8def84a0bf14f682b3751b8f7a453da2cea47099734a72859028155b2d39c"
      hash2 = "a393449a5f19109160384b13d60bb40601af2ef5f08839b5223f020f1f83e990"
   strings:
      $s1 = "User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.101 Safari/537.36" fullword ascii
      $s2 = "GET /g.php HTTP/1.1" fullword ascii
      $s3 = "https://%[^/]/%s" fullword ascii
      $s4 = "pass\" value=\"[^\"]*\"" fullword ascii
      $s5 = "jbeupq84v7.2y.net" fullword ascii
   condition:
      ( uint16(0) == 0x457f and filesize < 5000KB and 2 of them )
}
// --
rule m29_MAL_ELF_LNX_Mirai_Oct10_1 {
   meta:
      title            = "Malware. ELF Mirai variant"
      author           = "Florian Roth"
      source           = "https://github.com/Neo23x0/signature-base"
      description      = "Detects ELF Mirai variant"
      created_date     = "2018-10-27"
      reference        = "Internal Research"
      hash1 = "3be2d250a3922aa3f784e232ce13135f587ac713b55da72ef844d64a508ddcfe"
   strings:
      $x1 = " -r /vi/mips.bushido; "
      $x2 = "/bin/busybox chmod 777 * /tmp/" fullword ascii

      $s1 = "POST /ctrlt/DeviceUpgrade_1 HTTP/1.1" fullword ascii
      $s2 = "loadURL>$(echo HUAWEIUPNP)</NewDownloadURL></u:Upgrade></s:Body></s:Envelope>" fullword ascii
      $s3 = "POST /cdn-cgi/" fullword ascii
   condition:
      uint16(0) == 0x457f and filesize < 200KB and (
         ( 1 of ($x*) and 1 of ($s*) ) or
         all of ($x*)
      )
}
// --
rule m30_MAL_ELF_LNX_Mirai_Oct10_2 {
   meta:
      title            = "Malware. ELF malware Mirai related"
      author           = "Florian Roth"
      source           = "https://github.com/Neo23x0/signature-base"
      description      = "Detects ELF malware Mirai related"
      created_date     = "2018-10-27"
      reference        = "Internal Research"
      hash1            = "fa0018e75f503f9748a5de0d14d4358db234f65e28c31c8d5878cc58807081c9"
   strings:
      $c01 = { 50 4F 53 54 20 2F 63 64 6E 2D 63 67 69 2F 00 00
               20 48 54 54 50 2F 31 2E 31 0D 0A 55 73 65 72 2D
               41 67 65 6E 74 3A 20 00 0D 0A 48 6F 73 74 3A }
   condition:
      uint16(0) == 0x457f and filesize < 200KB and all of them
}
// --
rule m31_MAL_Mirai_Nov19_1 {
   meta:
      title            = "Malware. Mirai malware"
      author           = "Florian Roth"
      source           = "https://github.com/Neo23x0/signature-base"
      description      = "Detects Mirai malware"
      created_date     = "2019-11-13"
      reference        = "https://twitter.com/bad_packets/status/1194049104533282816"
      hash1 = "bbb83da15d4dabd395996ed120435e276a6ddfbadafb9a7f096597c869c6c739"
      hash2 = "fadbbe439f80cc33da0222f01973f27cce9f5ab0709f1bfbf1a954ceac5a579b"
   strings:
      $s1 = "SERVZUXO" fullword ascii
      $s2 = "-loldongs" fullword ascii
      $s3 = "/dev/null" fullword ascii
      $s4 = "/bin/busybox" fullword ascii
      $sc1 = { 47 72 6F 75 70 73 3A 09 30 }
   condition:
      uint16(0) == 0x457f and filesize <= 100KB and 4 of them
}
// --
rule m32_MAL_ARM_LNX_Mirai_Mar13_2022 {
   meta:
      title            = "Malware. New ARM Mirai variant"
      author           = "Mehmet Ali Kerimoglu a.k.a. CYB3RMX"
      source           = "https://github.com/Neo23x0/signature-base"
      description      = "Detects new ARM Mirai variant"
      created_date     = "2022-03-16"
      reference        = "https://www.iso.org/standard/54796.html"
      hash1 = "0283b72913b8a78b2a594b2d40ebc3c873e4823299833a1ff6854421378f5a68"
   strings:
      $str1 = "/home/landley/aboriginal/aboriginal/build/temp-armv6l/gcc-core/gcc/config/arm/lib1funcs.asm"
      $str2 = "/home/landley/aboriginal/aboriginal/build/temp-armv6l/gcc-core/gcc/config/arm/lib1funcs.asm"
      $str3 = "/home/landley/aboriginal/aboriginal/build/temp-armv6l/gcc-core/gcc/config/arm"
      $str4 = "/home/landley/aboriginal/aboriginal/build/simple-cross-compiler-armv6l/bin/../cc/include"
      $attck1 = "attack.c"
      $attck2 = "attacks.c"
      $attck3 = "anti_gdb_entry"
      $attck4 = "resolve_cnc_addr"
      $attck5 = "attack_gre_eth"
      $attck6 = "attack_udp_generic"
      $attck7 = "attack_get_opt_ip"
      $attck8 = "attack_icmpecho"
   condition:
      uint16(0) == 0x457f and ( 3 of ($str*) or 4 of ($attck*) )
}
// --
rule m46_CRC32_table_lookup {
  meta:
    title            = "Crypto Manipulation. CRC32 table lookup"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Look for CRC32 table lookup"
    created_date     = "2015-06"
    reference        = "https://www.iso.org/standard/54796.html"
    version = "0.1"
  strings:
    $c0 = { 8B 54 24 08 85 D2 7F 03 33 C0 C3 83 C8 FF 33 C9 85 D2 7E 29 56 8B 74 24 08 57 8D 9B 00 00 00 00 0F B6 3C 31 33 F8 81 E7 FF 00 00 00 C1 E8 08 33 04 BD ?? ?? ?? ?? 41 3B CA 7C E5 5F 5E F7 D0 C3 }
  condition:
    $c0
}
// --
rule m49_FlyUtilsCnDES_ECB_Encrypt {
  meta:
    title            = "FlyUtils.CnDES Encrypt ECB function"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Look for FlyUtils.CnDES Encrypt ECB function"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 83 C4 E8 53 56 57 33 DB 89 5D E8 89 5D EC 8B D9 89 55 F8 89 45 FC 8B 7D 08 8B 75 20 8B 45 FC E8 ?? ?? ?? ?? 8B 45 F8 E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 80 7D 18 00 74 1A 0F B6 55 18 8D 4D EC 8B 45 F8 E8 ?? ?? ?? ?? 8B 55 EC 8D 45 F8 E8 ?? ?? ?? ?? 80 7D 1C 00 74 1A 0F B6 55 1C 8D 4D E8 8B 45 FC E8 ?? ?? ?? ?? 8B 55 E8 8D 45 FC E8 ?? ?? ?? ?? 85 DB 75 07 E8 ?? ?? ?? ?? 8B D8 85 F6 75 07 E8 ?? ?? ?? ?? 8B F0 53 6A 00 8B 4D FC B2 01 A1 ?? ?? ?? ?? E8 ?? ?? ?? ?? 89 45 F4 33 D2 55 68 ?? ?? ?? ?? 64 FF 32 64 89 22 6A 00 6A 00 8B 45 F4 E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 50 6A 00 33 C9 B2 01 A1 ?? ?? ?? ?? E8 ?? ?? ?? ?? 89 45 F0 33 D2 55 68 ?? ?? ?? ?? 64 FF 32 64 89 22 6A 00 6A 00 56 }
  condition:
    $c0
}
// --
rule m50_FlyUtilsCnDES_ECB_Decrypt {
  meta:
    title            = "Crypto Manipulation. FlyUtils.CnDES Decrypt ECB function"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Look for FlyUtils.CnDES Decrypt ECB function"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"

  strings:
    $c0 = { 55 8B EC 83 C4 E8 53 56 57 33 DB 89 5D E8 89 5D EC 8B F9 89 55 F8 89 45 FC 8B 5D 18 8B 75 20 8B 45 FC E8 ?? ?? ?? ?? 8B 45 F8 E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 84 DB 74 18 8B D3 8D 4D EC 8B 45 F8 E8 ?? ?? ?? ?? 8B 55 EC 8D 45 F8 E8 ?? ?? ?? ?? 85 FF 75 07 E8 ?? ?? ?? ?? 8B F8 85 F6 75 07 E8 ?? ?? ?? ?? 8B F0 8B 4D FC B2 01 A1 ?? ?? ?? ?? E8 ?? ?? ?? ?? 89 45 F4 33 D2 55 68 ?? ?? ?? ?? 64 FF 32 64 89 22 57 6A 00 33 C9 B2 01 A1 ?? ?? ?? ?? E8 ?? ?? ?? ?? 89 45 F0 33 D2 55 68 ?? ?? ?? ?? 64 FF 32 64 89 22 6A 00 6A 00 56 E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 50 FF 75 14 FF 75 10 8B 45 0C 50 8B 4D F8 8B 55 F0 8B 45 F4 E8 ?? ?? ?? ?? 6A 00 6A 00 8B 45 F0 E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8B 55 08 8B 45 F0 E8 ?? ?? ?? ?? 33 C0 5A 59 59 64 89 10 EB 12 E9 ?? ?? ?? ?? 8B 45 08 E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 5A 59 59 64 89 10 68 ?? ?? ?? ?? 8B 45 F0 33 D2 89 55 F0 E8 ?? ?? ?? ?? C3 }
  condition:
    $c0
}
// --
rule m51_Elf_Hash {
  meta:
    title            = "Crypto Manipulation. ElfHash"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Look for ElfHash"
    created_date     = "2015-06"
    reference        = "https://www.iso.org/standard/54796.html"
    version = "0.3"
  strings:
    $c0 = { 53 56 33 C9 8B DA 4B 85 DB 7C 25 43 C1 E1 04 33 D2 8A 10 03 CA 8B D1 81 E2 00 00 00 F0 85 D2 74 07 8B F2 C1 EE 18 33 CE F7 D2 23 CA 40 4B 75 DC 8B C1 5E 5B C3 }
    $c1 = { 53 33 D2 85 C0 74 2B EB 23 C1 E2 04 81 E1 FF 00 00 00 03 D1 8B CA 81 E1 00 00 00 F0 85 C9 74 07 8B D9 C1 EB 18 33 D3 F7 D1 23 D1 40 8A 08 84 C9 75 D7 8B C2 5B C3 }
    $c2 = { 53 56 33 C9 8B D8 85 D2 76 23 C1 E1 04 33 C0 8A 03 03 C8 8B C1 25 00 00 00 F0 85 C0 74 07 8B F0 C1 EE 18 33 CE F7 D0 23 C8 43 4A 75 DD 8B C1 5E 5B C3 }
    $c3 = { 53 56 57 8B F2 8B D8 8B FB 53 E8 ?? ?? ?? ?? 6B C0 02 71 05 E8 ?? ?? ?? ?? 8B D7 33 C9 8B D8 83 EB 01 71 05 E8 ?? ?? ?? ?? 85 DB 7C 2C 43 C1 E1 04 0F B6 02 03 C8 71 05 E8 ?? ?? ?? ?? 83 C2 01 B8 00 00 00 F0 23 C1 85 C0 74 07 8B F8 C1 EF 18 33 CF F7 D0 23 C8 4B 75 D5 8B C1 99 F7 FE 8B C2 85 C0 7D 09 03 C6 71 05 E8 ?? ?? ?? ?? 5F 5E 5B C3 }
    $c4 = { 53 33 D2 EB 2C 8B D9 80 C3 BF 80 EB 1A 73 03 80 C1 20 C1 E2 04 81 E1 FF 00 00 00 03 D1 8B CA 81 E1 00 00 00 F0 8B D9 C1 EB 18 33 D3 F7 D1 23 D1 40 8A 08 84 C9 75 CE 8B C2 5B C3 }
    $c5 = { 89 C2 31 C0 85 D2 74 30 2B 42 FC 74 2B 89 C1 29 C2 31 C0 53 0F B6 1C 11 01 C3 8D 04 1B C1 EB 14 8D 04 C5 00 00 00 00 81 E3 00 0F 00 00 31 D8 83 C1 01 75 E0 C1 E8 04 5B C3 }
    $c6 = { 53 33 D2 85 C0 74 38 EB 30 8B D9 80 C3 BF 80 EB 1A 73 03 80 C1 20 C1 E2 04 81 E1 FF 00 00 00 03 D1 8B CA 81 E1 00 00 00 F0 85 C9 74 07 8B D9 C1 EB 18 33 D3 F7 D1 23 D1 40 8A 08 84 C9 75 CA 8B C2 5B C3 }
  condition:
    any of them
}
// --
rule m62_DarkEYEv3_Cryptor {
  meta:
    title            = "Crypto Manipulation (Malware). DarkEYEv3 encrypted executables"
    author           = "Florian Roth"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Rule to detect DarkEYEv3 encrypted executables (often malware)"
    created_date     = "2015-05-24"
    reference        = "http://darkeyev3.blogspot.fi/"
    hash0 = "6b854b967397f7de0da2326bdd5d39e710e2bb12"
    hash1 = "d53149968eca654fc0e803f925e7526fdac2786c"
    hash2 = "7e3a8940d446c57504d6a7edb6445681cca31c65"
    hash3 = "d3dd665dd77b02d7024ac16eb0949f4f598299e7"
    hash4 = "a907a7b74a096f024efe57953c85464e87275ba3"
    hash5 = "b1c422155f76f992048377ee50c79fe164b22293"
    hash6 = "29f5322ce5e9147f09e0a86cc23a7c8dc88721b9"
    hash7 = "a0382d7c12895489cb37efef74c5f666ea750b05"
    hash8 = "f3d5b71b7aeeb6cc917d5bb67e2165cf8a2fbe61"
    score = 55
  strings:
    $s0 = "\\DarkEYEV3-"
  condition:
    uint16(0) == 0x5a4d and $s0
}
// --
rule m63_Miracl_powmod
{ meta:
    title            = "Crypto Manipulation. Miracl powmod"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Miracl powmod"
    created_date     = "2014-02"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 53 55 56 57 E8 ?? ?? ?? ?? 8B F0 8B 86 18 02 00 00 85 C0 0F 85 EC 01 00 00 8B 56 1C 42 8B C2 89 56 1C 83 F8 18 7D 17 C7 44 86 20 12 00 00 00 8B 86 2C 02 00 00 85 C0 74 05 E8 ?? ?? ?? ?? 8B 06 8B 4E 10 3B C1 74 2E 8B 7C 24 1C 57 E8 ?? ?? ?? ?? 83 C4 04 83 F8 02 7C 33 8B 57 04 8B 0E 51 8B 02 50 E8 ?? ?? ?? ?? 83 C4 08 83 F8 01 0F 84 58 01 00 00 EB 17 8B 7C 24 1C 6A 02 57 E8 ?? ?? ?? ?? 83 C4 08 85 C0 0F 84 3F 01 00 00 8B 8E C4 01 00 00 8B 54 24 18 51 52 E8 ?? ?? ?? ?? 8B 86 CC }
  condition:
    $c0
}
// --
rule m64_Miracl_crt
{ meta:
    title            = "Crypto Manipulation. Miracl crt"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Miracl crt"
    created_date     = "2014-02"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 51 56 57 E8 ?? ?? ?? ?? 8B 74 24 10 8B F8 89 7C 24 08 83 7E 0C 02 0F 8C 99 01 00 00 8B 87 18 02 00 00 85 C0 0F 85 8B 01 00 00 8B 57 1C 42 8B C2 89 57 1C 83 F8 18 7D 17 C7 44 87 20 4A 00 00 00 8B 87 2C 02 00 00 85 C0 74 05 E8 ?? ?? ?? ?? 8B 46 04 8B 54 24 14 53 55 8B 08 8B 02 51 50 E8 ?? ?? ?? ?? 8B 4E 0C B8 01 00 00 00 83 C4 08 33 ED 3B C8 89 44 24 18 0F 8E C5 00 00 00 BF 04 00 00 00 8B 46 04 8B 0C 07 8B 10 8B 44 24 1C 51 52 8B 0C 07 51 E8 ?? ?? ?? ?? 8B 56 04 8B 4E 08 8B 04 }
  condition:
    $c0
}
// --
rule m67_FGint_MontgomeryModExp
{ meta:
    title            = "Crypto Manipulation. FGint MontgomeryModExp"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint MontgomeryModExp"
    created_date     = "2015-06"
    reference        = "https://www.iso.org/standard/54796.html"
    version = "0.2"
  strings:
    $c0 = { 55 8B EC 83 C4 ?? 53 56 57 33 DB 89 5D ?? 8B F1 8B DA 89 45 ?? 8B 7D 08 8D 45 F4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 EC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 DC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 ?? 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8D 55 D4 B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B CF 8B D6 8B 45 FC E8 ?? ?? ?? ?? 8D 55 D4 8B C7 E8 ?? ?? ?? ?? 3C 02 75 0D 8D 45 D4 E8 ?? ?? ?? ?? E9 }
    $c1 = { 55 8B EC 83 C4 ?? 53 56 57 33 DB 89 5D ?? 8B F1 8B DA 89 45 ?? 8D 45 F4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 EC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 DC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 D4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8D 55 D4 B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B CF 8B D6 8B 45 FC E8 ?? ?? ?? ?? 8D 55 D4 8B C7 E8 ?? ?? ?? ?? 3C 02 75 0D 8D 45 D4 E8 ?? ?? ?? ?? E9 }
    $c2 = { 55 8B EC 83 C4 ?? 53 56 57 33 DB 89 5D ?? 8B F1 8B DA 89 45 ?? 8B 7D 08 8D 45 F4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 EC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 DC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 ?? 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 ?? 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 ?? 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8D 55 D4 B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B CF 8B D6 8B 45 ?? E8 ?? ?? ?? ?? 8D 55 D4 8B C7 E8 ?? ?? ?? ?? 3C 02 75 0D 8D 45 D4 E8 ?? ?? ?? ?? E9 }
    $c3 = { 55 8B EC 83 C4 ?? 53 56 57 33 DB 89 5D ?? 8B F1 8B DA 89 45 D0 8B 7D 08 8D 45 F4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 EC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 DC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 D4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 47 4C 47 00 64 FF 30 64 89 20 8D 55 D4 B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B CF 8B D6 8B 45 D0 E8 ?? ?? ?? ?? 8D 55 D4 8B C7 E8 ?? ?? ?? ?? 3C 02 75 0D 8D 45 D4 E8 ?? ?? ?? ?? E9 02 02 00 00 }
  condition:
    any of them
}
// --
rule m68_FGint_FGIntModExp
{ meta:
    title            = "Crypto Manipulation. FGint FGIntModExp"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint FGIntModExp"
    created_date     = "2015-05"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 83 C4 E8 53 56 57 33 DB 89 5D ?? 8B F1 89 55 ?? 8B D8 8B 7D 08 8D 45 F4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 EC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8B 46 04 8B 40 04 83 E0 01 83 F8 01 75 0F 57 8B CE 8B 55 ?? 8B C3 E8 ?? ?? ?? ?? EB ?? 8D 55 ?? 8B 45 ?? E8 ?? ?? ?? ?? 8B D7 B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 55 F4 8B C3 E8 ?? ?? ?? ?? 8B 45 }
  condition:
    $c0
}
// --
rule m69_FGint_MulByInt
{ meta:
    title            = "Crypto Manipulation. FGint MulByInt"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint MulByInt"
    created_date     = "2015-05"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 53 56 57 55 83 C4 E8 89 4C 24 04 8B EA 89 04 24 8B 04 24 8B 40 04 8B 00 89 44 24 08 8B 44 24 08 83 C0 02 50 8D 45 04 B9 01 00 00 00 8B 15 ?? ?? ?? ?? ?? ?? ?? ?? ?? 83 C4 04 33 F6 8B 7C 24 08 85 FF 76 6D BB 01 00 00 00 8B 04 24 8B 40 04 8B 04 98 33 D2 89 44 24 10 89 54 24 14 8B 44 24 04 33 D2 52 50 8B 44 24 18 8B 54 24 1C ?? ?? ?? ?? ?? 89 44 24 10 89 54 24 14 8B C6 33 D2 03 44 24 10 13 54 24 14 89 44 24 10 89 54 24 14 8B 44 24 10 25 FF FF FF 7F 8B 55 04 89 04 9A 8B 44 24 10 8B 54 24 14 0F AC D0 1F C1 EA 1F 8B F0 43 4F 75 98 }
  condition:
    $c0
}
// --
rule m70_FGint_DivMod
{ meta:
    title            = "Crypto Manipulation. FGint FGIntDivMod"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint FGIntDivMod"
    created_date     = "2015-05"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 83 C4 BC 53 56 57 8B F1 89 55 F8 89 45 FC 8B 5D 08 8D 45 F0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 D8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8B 45 FC 8A 00 88 45 D7 8B 45 F8 8A 00 88 45 D6 8B 45 FC E8 ?? ?? ?? ?? 8B 45 F8 E8 ?? ?? ?? ?? 8B D3 8B 45 FC E8 ?? ?? ?? ?? 8D 55 E0 8B 45 F8 E8 ?? ?? ?? ?? 8B 55 F8 8B 45 FC }
  condition:
    $c0
}
// --
rule m71_FGint_FGIntDestroy
{ meta:
    title            = "Crypto Manipulation. FGint FGIntDestroy"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint FGIntDestroy"
    created_date     = "2015-05"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 53 8B D8 8D 43 04 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 5B C3 }
  condition:
    $c0
}
// --
rule m72_FGint_Base10StringToGInt
{ meta:
    title            = "Crypto Manipulation. FGint Base10StringToGInt"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint Base10StringToGInt"
    created_date     = "2015-06"
    reference        = "https://www.iso.org/standard/54796.html"
    version = "0.2"
  strings:
    $c0 = { 55 8B EC B9 04 00 00 00 6A 00 6A 00 49 75 F9 51 53 56 57 8B DA 89 45 FC 8B 45 FC ?? ?? ?? ?? ?? 33 C0 55 ?? ?? ?? ?? ?? 64 FF 30 64 89 20 EB 12 8D 45 FC B9 01 00 00 00 BA 01 00 00 00 ?? ?? ?? ?? ?? 8B 45 FC 8A 00 2C 2D 74 11 04 FD 2C 0A 72 0B 8B 45 FC ?? ?? ?? ?? ?? 48 7F D4 8D 45 E4 50 B9 01 00 00 00 BA 01 00 00 00 8B 45 FC ?? ?? ?? ?? ?? 8B 45 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 75 18 C6 45 EB 00 8D 45 FC B9 01 00 00 00 BA 01 00 00 00 ?? ?? ?? ?? ?? EB 18 C6 45 EB 01 EB 12 8D 45 FC }
    $c1 = { 55 8B EC 83 C4 D8 53 56 57 33 C9 89 4D D8 89 4D DC 89 4D E0 89 4D E4 89 4D EC 8B DA 89 45 FC 8B 45 FC E8 ?? ?? ?? ?? 33 C0 55 68 0F 42 45 00 64 FF 30 64 89 20 EB 12 8D 45 FC B9 01 00 00 00 BA 01 00 00 00 E8 ?? ?? ?? ?? 8B 45 FC 8A 00 2C 2D 74 11 04 FD 2C 0A 72 0B 8B 45 FC E8 ?? ?? ?? ?? 48 7F D4 8D 45 E4 50 B9 01 00 00 00 BA 01 00 00 00 8B 45 FC E8 ?? ?? ?? ?? 8B 45 E4 BA 28 42 45 00 E8 ?? ?? ?? ?? 75 18 C6 45 EB 00 8D 45 FC B9 01 00 00 00 BA 01 00 00 00 E8 ?? ?? ?? ?? EB 18 C6 45 EB 01 }
    $c2 = { 55 8B EC 83 C4 D8 53 56 33 C9 89 4D D8 89 4D DC 89 4D E0 89 4D F8 89 4D F4 8B DA 89 45 FC 8B 45 FC E8 ?? ?? ?? ?? 33 C0 55 68 A6 32 47 00 64 FF 30 64 89 20 EB 12 8D 45 FC B9 01 00 00 00 BA 01 00 00 00 E8 ?? ?? ?? ?? 8B 45 FC 0F B6 00 2C 2D 74 11 04 FD 2C 0A 72 0B 8B 45 FC E8 ?? ?? ?? ?? 48 7F D3 8D 45 E0 50 B9 01 00 00 00 BA 01 00 00 00 8B 45 FC E8 ?? ?? ?? ?? 8B 45 E0 BA BC 32 47 00 E8 ?? ?? ?? ?? 75 18 C6 45 E9 00 8D 45 FC B9 01 00 00 00 BA 01 00 00 00 E8 ?? ?? ?? ?? EB 18 C6 45 E9 01 }

  condition:
    any of them
}
// --
rule m73_FGint_ConvertBase256to64
{ meta:
    title            = "Crypto Manipulation. FGint ConvertBase256to64"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint ConvertBase256to64"
    created_date     = "2015-05"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 81 C4 EC FB FF FF 53 56 57 33 C9 89 8D EC FB FF FF 89 8D F0 FB FF FF 89 4D F8 8B FA 89 45 FC B9 00 01 00 00 8D 85 F4 FB FF FF 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8D 85 F4 FB FF FF BA FF 00 00 00 E8 ?? ?? ?? ?? 8D 45 F8 E8 ?? ?? ?? ?? 8B 45 FC E8 ?? ?? ?? ?? 8B D8 85 DB 7E 2F BE 01 00 00 00 8D 45 F8 8B 55 FC 0F B6 54 32 FF 8B 94 95 F4 FB FF FF E8 ?? ?? ?? ?? 46 4B 75 E5 EB }
  condition:
    $c0
}
// --
rule m74_FGint_ConvertHexStringToBase256String
{ meta:
    title            = "Crypto Manipulation. FGint ConvertHexStringToBase256String"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint ConvertHexStringToBase256String"
    created_date     = "2015-05"
    reference        = "https://www.iso.org/standard/54796.html"
    version = "0.2"
  strings:
    $c0 = { 55 8B EC 83 C4 F0 53 56 33 C9 89 4D F0 89 55 F8 89 45 FC 8B 45 FC E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8B 45 F8 E8 ?? ?? ?? ?? 8B 45 FC E8 ?? ?? ?? ?? D1 F8 79 03 83 D0 00 85 C0 7E 5F 89 45 F4 BE 01 00 00 00 8B C6 03 C0 8B 55 FC 8A 54 02 FF 8B 4D FC 8A 44 01 FE 3C 3A 73 0A 8B D8 80 EB 30 C1 E3 04 EB 08 8B D8 80 EB 37 C1 E3 04 80 FA 3A 73 07 80 EA 30 0A DA EB 05 80 EA 37 0A DA 8D 45 F0 8B D3 }
  condition:
    $c0
}
// --
rule m75_FGint_Base256StringToGInt
{ meta:
    title            = "Crypto Manipulation. FGint Base256StringToGInt"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint Base256StringToGInt"
    created_date     = "2015-05"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 81 C4 F8 FB FF FF 53 56 57 33 C9 89 4D F8 8B FA 89 45 FC 8B 45 FC ?? ?? ?? ?? ?? B9 00 01 00 00 8D 85 F8 FB FF FF 8B 15 ?? ?? ?? ?? ?? ?? ?? ?? ?? 33 C0 55 ?? ?? ?? ?? ?? 64 FF 30 64 89 20 8D 45 F8 ?? ?? ?? ?? ?? 8D 85 F8 FB FF FF BA FF 00 00 00 ?? ?? ?? ?? ?? 8B 45 FC ?? ?? ?? ?? ?? 8B D8 85 DB 7E 34 BE 01 00 00 00 8D 45 F8 8B 55 FC 0F B6 54 32 FF 8B 94 95 F8 FB FF FF ?? ?? ?? ?? ?? 46 4B 75 E5 EB 12 8D 45 F8 B9 01 00 00 00 BA 01 00 00 00 ?? ?? ?? ?? ?? 8B 45 F8 80 38 30 75 0F }
  condition:
    $c0
}
// --
rule m76_FGint_FGIntToBase256String
{ meta:
    title            = "Crypto Manipulation. FGint FGIntToBase256String"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint FGIntToBase256String"
    created_date     = "2015-05"
    reference        = "https://www.iso.org/standard/54796.html"
    version = "0.2"
  strings:
    $c0 = { 55 8B EC 33 C9 51 51 51 51 53 56 8B F2 33 D2 55 68 ?? ?? ?? ?? 64 FF 32 64 89 22 8D 55 FC E8 ?? ?? ?? ?? EB 10 8D 45 FC 8B 4D FC BA ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B 45 FC E8 ?? ?? ?? ?? 25 07 00 00 80 79 05 48 83 C8 F8 40 85 C0 75 D8 8B 45 FC E8 ?? ?? ?? ?? 8B D8 85 DB 79 03 83 C3 07 C1 FB 03 8B C6 E8 ?? ?? ?? ?? 85 DB 76 4B 8D 45 F4 50 B9 08 00 00 00 BA 01 00 00 00 8B 45 FC E8 ?? ?? ?? ?? 8B 55 F4 8D 45 FB E8 ?? ?? ?? ?? 8D 45 F0 8A 55 FB E8 ?? ?? ?? ?? 8B 55 F0 8B C6 E8 ?? ?? ?? ?? 8D 45 FC B9 08 00 00 00 BA 01 00 00 00 E8 ?? ?? ?? ?? 4B 75 B5 }
    $c1 = { 55 8B EC 33 C9 51 51 51 51 53 56 8B F2 33 D2 55 68 ?? ?? ?? ?? 64 FF 32 64 89 22 8D 55 FC E8 ?? ?? ?? ?? EB 10 8D 45 FC 8B 4D FC BA ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B 45 FC E8 ?? ?? ?? ?? 25 07 00 00 80 79 05 48 83 C8 F8 40 85 C0 75 D8 8B 45 FC 85 C0 74 05 83 E8 04 8B 00 8B D8 85 DB 79 03 83 C3 07 C1 FB 03 8B C6 E8 ?? ?? ?? ?? 85 DB 76 4C 8D 45 F4 50 B9 08 00 00 00 BA 01 00 00 00 8B 45 FC E8 ?? ?? ?? ?? 8B 55 F4 8D 45 FB E8 ?? ?? ?? ?? 8D 45 F0 0F B6 55 FB E8 ?? ?? ?? ?? 8B 55 F0 8B C6 E8 ?? ?? ?? ?? 8D 45 FC B9 08 00 00 00 BA 01 00 00 00 E8 }
  condition:
    any of them
}
// --
rule m77_FGint_ConvertBase256StringToHexString
{ meta:
    title            = "Crypto Manipulation. FGint ConvertBase256StringToHexString"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint ConvertBase256StringToHexString"
    created_date     = "2015-05"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 33 C9 51 51 51 51 51 51 53 56 57 8B F2 89 45 FC 8B 45 FC E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8B C6 E8 ?? ?? ?? ?? 8B 45 FC E8 ?? ?? ?? ?? 8B F8 85 FF 0F 8E AB 00 00 00 C7 45 F8 01 00 00 00 8B 45 FC 8B 55 F8 8A 5C 10 FF 33 C0 8A C3 C1 E8 04 83 F8 0A 73 1E 8D 45 F4 33 D2 8A D3 C1 EA 04 83 C2 30 E8 ?? ?? ?? ?? 8B 55 F4 8B C6 E8 ?? ?? ?? ?? EB 1C 8D 45 F0 33 D2 8A D3 C1 EA 04 83 C2 37 E8 ?? ?? ?? ?? 8B 55 F0 8B C6 E8 ?? ?? ?? ?? 8B C3 24 0F 3C 0A 73 22 8D 45 EC 8B D3 80 E2 0F 81 E2 FF 00 00 00 83 C2 30 E8 ?? ?? ?? ?? 8B 55 EC 8B C6 E8 ?? ?? ?? ?? EB 20 8D 45 E8 8B D3 80 E2 0F 81 E2 FF 00 00 00 83 C2 37 }
  condition:
    $c0
}
// --
rule m78_FGint_PGPConvertBase256to64
{ meta:
    title            = "Crypto Manipulation. FGint PGPConvertBase256to64"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint PGPConvertBase256to64"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 81 C4 E8 FB FF FF 53 56 57 33 C9 89 8D E8 FB FF FF 89 4D F8 89 4D F4 89 4D F0 8B FA 89 45 FC B9 00 01 00 00 8D 85 EC FB FF FF 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8D 85 EC FB FF FF BA FF 00 00 00 E8 ?? ?? ?? ?? 8D 45 F8 E8 ?? ?? ?? ?? 8B 45 FC 8B 00 E8 ?? ?? ?? ?? 8B D8 85 DB 7E 22 BE 01 00 00 00 8D 45 F8 8B 55 FC 8B 12 0F B6 54 32 FF 8B 94 95 EC FB FF FF E8 ?? ?? ?? ?? 46 4B 75 E3 8B 45 F8 E8 ?? ?? ?? ?? B9 06 00 00 00 99 F7 F9 85 D2 75 0A 8D 45 F0 E8 ?? ?? ?? ?? EB 4B 8B 45 F8 E8 ?? ?? ?? ?? B9 06 00 00 00 99 F7 F9 83 FA 04 75 1C 8D 45 F8 BA 4C 33 40 00 E8 ?? ?? ?? ?? 8D 45 F0 BA 58 33 40 00 E8 ?? ?? ?? ?? EB 1A 8D 45 F8 BA ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 F0 BA ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B C7 E8 ?? ?? ?? ?? 8B 45 F8 E8 ?? ?? ?? ?? B9 06 00 00 00 99 F7 F9 8B D8 85 DB 7E 57 8D 45 F4 50 B9 06 00 00 00 BA 01 00 00 00 8B 45 F8 E8 ?? ?? ?? ?? 8D 45 EC 8B 55 F4 E8 ?? ?? ?? ?? 8D 85 E8 FB FF FF 8B 55 EC 8A 92 ?? ?? ?? ?? E8 }
  condition:
    $c0
}


rule m79_FGint_RSAEncrypt
{ meta:
    title            = "Crypto Manipulation. FGint RSAEncrypt"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint RSAEncrypt"
    created_date     = "2015-05"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 83 C4 D0 53 56 57 33 DB 89 5D D0 89 5D DC 89 5D D8 89 5D D4 8B F9 89 55 F8 89 45 FC 8B 45 FC E8 ?? ?? ?? ?? 8D 45 F0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8D 55 E0 B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 55 DC 8B C7 E8 ?? ?? ?? ?? 8B 45 DC E8 ?? ?? ?? ?? 8B D8 8D 55 DC 8B 45 FC E8 ?? ?? ?? ?? 8D 45 DC 8B 4D DC BA ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B F3 4E EB 10 }
  condition:
    $c0
}
// --
rule m80_FGint_RsaDecrypt
{ meta:
    title            = "Crypto Manipulation. FGint RsaDecrypt"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint RsaDecrypt"
    created_date     = "2015-05"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 83 C4 A0 53 56 57 33 DB 89 5D A0 89 5D A4 89 5D A8 89 5D B4 89 5D B0 89 5D AC 89 4D F8 8B FA 89 45 FC 8B 45 FC E8 ?? ?? ?? ?? 8D 45 F0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 D8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 D0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 C8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 C0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 B8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 }
  condition:
    $c0
}
// --
rule m81_FGint_RSAVerify
{ meta:
    title            = "Crypto Manipulation. FGint RSAVerify"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint RSAVerify"
    created_date     = "2015-05"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 83 C4 E0 53 56 8B F1 89 55 F8 89 45 FC 8B 5D 0C 8B 45 FC E8 ?? ?? ?? ?? 8B 45 F8 E8 ?? ?? ?? ?? 8D 45 F0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8D 55 E8 8B 45 F8 E8 ?? ?? ?? ?? 8D 55 F0 8B 45 FC E8 ?? ?? ?? ?? 8D 4D E0 8B D3 8D 45 F0 E8 ?? ?? ?? ?? 8D 55 F0 8D 45 E0 E8 ?? ?? ?? ?? 8D 45 E0 50 8B CB 8B D6 8D 45 E8 E8 ?? ?? ?? ?? 8D 55 E8 8D 45 E0 E8 ?? ?? ?? ?? 8D 55 F0 8D 45 E8 E8 ?? ?? ?? ?? 3C 02 8B 45 08 0F 94 00 8D 45 E8 E8 ?? ?? ?? ?? 8D 45 F0 E8 ?? ?? ?? ?? 33 C0 5A 59 59 64 89 10 68 ?? ?? ?? ?? 8D 45 E0 8B 15 ?? ?? ?? ?? B9 03 00 00 00 E8 ?? ?? ?? ?? 8D 45 F8 BA 02 00 00 00 E8 ?? ?? ?? ?? C3 }
  condition:
    $c0
}
// --
rule m83_FGint_ECElGamalEncrypt
{ meta:
    title            = "Crypto Manipulation. FGint ECElGamalEncrypt"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint ECElGamalEncrypt"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
    version = "0.1"
  strings:
    $c0 = { 55 8B EC 81 C4 3C FF FF FF 53 56 57 33 DB 89 5D D8 89 5D D4 89 5D D0 8B 75 10 8D 7D 8C A5 A5 A5 A5 A5 8B 75 14 8D 7D A0 A5 A5 A5 A5 A5 8B 75 18 8D 7D DC A5 A5 8B 75 1C 8D 7D E4 A5 A5 8B F1 8D 7D EC A5 A5 8B F2 8D 7D F4 A5 A5 89 45 FC 8B 45 FC E8 ?? ?? ?? ?? 8D 45 F4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 EC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 DC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 A0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 8C 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 85 78 FF FF FF 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 85 64 FF FF FF 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 85 50 FF FF FF 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 85 3C FF FF FF 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 C4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 BC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 B4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 7D CF }
    $c1 = { 55 8B EC 83 C4 A8 53 56 57 33 DB 89 5D A8 89 5D AC 89 5D BC 89 5D B8 89 5D B4 89 4D F4 89 55 F8 89 45 FC 8B 75 0C 8B 45 FC E8 ?? ?? ?? ?? 8D 45 E8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 D8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 D0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 C8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 C0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 71 14 41 00 64 FF 30 64 89 20 8D 55 BC 8B C6 E8 ?? ?? ?? ?? 8B 45 BC E8 ?? ?? ?? ?? 8B D8 8D 55 BC 8B 45 FC E8 ?? ?? ?? ?? 8D 45 BC 8B 4D BC BA 8C 14 41 00 E8 ?? ?? ?? ?? 8B FB 4F EB 10 8D 45 BC 8B 4D BC BA 98 14 41 00 E8 ?? ?? ?? ?? 8B 45 BC }
  condition:
    $c0 or $c1
}
// --
rule m84_FGint_ECAddPoints
{ meta:
    title            = "Crypto Manipulation. FGint ECAddPoints"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint ECAddPoints"
    created_date     = "2015-06"
    reference        = "https://www.iso.org/standard/54796.html"
    version = "0.1"
  strings:
    $c0 = { 55 8B EC 83 C4 A8 53 56 57 8B 75 0C 8D 7D F0 A5 A5 8B F1 8D 7D F8 A5 A5 8B F2 8D 7D A8 A5 A5 A5 A5 A5 8B F0 8D 7D BC A5 A5 A5 A5 A5 8B 5D 08 8D 45 BC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 A8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 F8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 F0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 D8 8B 15 ?? ?? ?? ?? E8 }
  condition:
    $c0
}
// --
rule m85_FGint_ECPointKMultiple
{ meta:
    title            = "Crypto Manipulation. FGint ECPointKMultiple"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint ECPointKMultiple"
    created_date     = "2015-06"
    reference        = "https://www.iso.org/standard/54796.html"
    version = "0.1"
  strings:
    $c0 = { 55 8B EC 83 C4 BC 53 56 57 33 DB 89 5D E4 8B 75 0C 8D 7D E8 A5 A5 8B F1 8D 7D F0 A5 A5 8B F2 8D 7D F8 A5 A5 8B F0 8D 7D D0 A5 A5 A5 A5 A5 8B 5D 08 8D 45 D0 8B 15 ?? ?? ?? 00 E8 ?? ?? ?? ?? 8D 45 F8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 F0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 BC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 }
  condition:
    $c0
}
// --
rule m86_FGint_ECPointDestroy
{ meta:
    title            = "Crypto Manipulation. FGint ECPointDestroy"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint ECPointDestroy"
    created_date     = "2015-06"
    reference        = "https://www.iso.org/standard/54796.html"
    version = "0.1"
  strings:
    $c0 = { 53 8B D8 8B C3 E8 ?? ?? ?? ?? 8D 43 08 E8 ?? ?? ?? ?? 5B C3 }
  condition:
    $c0
}
// --
rule m87_FGint_DSAPrimeSearch
{ meta:
    title            = "Crypto Manipulation. FGint DSAPrimeSearch"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint DSAPrimeSearch"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
    version = "0.1"
  strings:
    $c0 = { 55 8B EC 83 C4 DC 53 56 8B DA 8B F0 8D 45 F8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 F0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8D 4D F8 8B D6 8B C6 E8 ?? ?? ?? ?? 8D 4D E8 8B D6 8B C3 E8 ?? ?? ?? ?? 8D 55 F0 B8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 4D E0 8D 55 E8 8B C3 E8 ?? ?? ?? ?? 8D 45 E8 E8 ?? ?? ?? ?? 8D 4D E8 8D 55 F0 8D 45 E0 E8 ?? ?? ?? ?? 8D 45 E0 E8 ?? ?? ?? ?? 8D 45 F0 E8 ?? ?? ?? ?? 8B 45 EC 8B 40 04 83 E0 01 85 C0 75 18 8D 4D E0 8B D6 8D 45 E8 E8 ?? ?? ?? ?? 8D 55 E8 8D 45 E0 E8 ?? ?? ?? ?? 8B D3 8D 45 E8 E8 ?? ?? ?? ?? C6 45 DF 00 EB 26 8D 4D E8 8D 55 F8 8B C3 E8 ?? ?? ?? ?? 8B D3 8D 45 E8 E8 ?? ?? ?? ?? 8D 4D DF 8B C3 BA 05 00 00 00 E8 ?? ?? ?? ?? 80 7D DF 00 74 D4 8D 45 F8 E8 ?? ?? ?? ?? 33 C0 5A 59 59 64 89 10 68 ?? ?? ?? ?? 8D 45 E0 8B 15 ?? ?? ?? ?? B9 04 00 00 00 E8 ?? ?? ?? ?? C3 }
  condition:
    $c0
}
// --
rule m88_FGint_DSASign
{ meta:
    title            = "Crypto Manipulation. FGint DSASign"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint DSASign"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
    version = "0.1"
  strings:
    $c0 = { 55 8B EC 83 C4 CC 53 56 57 89 4D FC 8B DA 8B F8 8B 75 14 8B 45 10 E8 ?? ?? ?? ?? 8D 45 F4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 EC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 DC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 D4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 CC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8D 45 F4 50 8B CF 8B D6 8B 45 FC E8 ?? ?? ?? ?? 8D 4D D4 8B D3 8D 45 F4 E8 ?? ?? ?? ?? 8D 45 F4 E8 ?? ?? ?? ?? 8D 4D F4 8B D3 8B C6 E8 ?? ?? ?? ?? 8D 55 EC 8B 45 10 E8 ?? ?? ?? ?? 8D 45 E4 50 8B CB 8D 55 D4 8B 45 18 E8 ?? ?? ?? ?? 8D 4D DC 8D 55 E4 8D 45 EC E8 ?? ?? ?? ?? 8D 45 EC E8 ?? ?? ?? ?? 8D 45 E4 E8 ?? ?? ?? ?? 8D 45 CC 50 8B CB 8D 55 DC 8D 45 F4 E8 ?? ?? ?? ?? 8D 45 F4 E8 ?? ?? ?? ?? 8D 45 DC E8 ?? ?? ?? ?? 8B 55 0C 8D 45 D4 E8 ?? ?? ?? ?? 8B 55 08 8D 45 CC E8 ?? ?? ?? ?? 8D 45 D4 E8 ?? ?? ?? ?? 8D 45 CC E8 ?? ?? ?? ?? 33 C0 5A 59 59 64 89 10 68 ?? ?? ?? ?? 8D 45 CC 8B 15 ?? ?? ?? ?? B9 06 00 00 00 E8 }
  condition:
    $c0
}
// --
rule m89_FGint_DSAVerify
{ meta:
    title            = "Crypto Manipulation. FGint DSAVerify"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint DSAVerify"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
    version = "0.1"
  strings:
    $c0 = { 55 8B EC 83 C4 B4 53 56 57 89 4D FC 8B DA 8B F0 8B 7D 08 8B 45 14 E8 ?? ?? ?? ?? 8B 45 10 E8 ?? ?? ?? ?? 8B 45 0C E8 ?? ?? ?? ?? 8D 45 F4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 EC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 DC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 D4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 CC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 C4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 BC 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 B4 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8D 55 CC 8B 45 0C E8 ?? ?? ?? ?? 8D 4D F4 8B D3 8D 45 CC E8 ?? ?? ?? ?? 8D 55 C4 8B 45 14 E8 ?? ?? ?? ?? 8D 45 EC 50 8B CB 8D 55 F4 8D 45 C4 E8 ?? ?? ?? ?? 8D 45 C4 E8 ?? ?? ?? ?? 8D 55 D4 8B 45 10 E8 ?? ?? ?? ?? 8D 45 E4 50 8B CB 8D 55 F4 8D 45 D4 E8 ?? ?? ?? ?? 8D 45 F4 E8 ?? ?? ?? ?? 8D 45 C4 50 8B CE 8D 55 EC 8B 45 FC E8 ?? ?? ?? ?? 8D 45 BC 50 8B CE 8D 55 E4 8B 45 18 E8 ?? ?? ?? ?? 8D 45 B4 50 8B CE 8D 55 BC 8D 45 C4 E8 ?? ?? ?? ?? 8D 45 C4 E8 }
  condition:
    $c0
}
// --
rule m92_DES_pbox_long
{ meta:
    title            = "Crypto Manipulation. DES [pbox] [long]"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "DES [pbox] [long]"
    created_date     = "2015-05"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 0F 00 00 00 06 00 00 00 13 00 00 00 14 00 00 00 1C 00 00 00 0B 00 00 00 1B 00 00 00 10 00 00 00 00 00 00 00 0E 00 00 00 16 00 00 00 19 00 00 00 04 00 00 00 11 00 00 00 1E 00 00 00 09 00 00 00 01 00 00 00 07 00 00 00 17 00 00 00 0D 00 00 00 1F 00 00 00 1A 00 00 00 02 00 00 00 08 00 00 00 12 00 00 00 0C 00 00 00 1D 00 00 00 05 00 00 00 }
  condition:
    $c0
}
// --
rule m96_OpenSSL_BN_mod_exp_simple
{ meta:
    title            = "Crypto Manipulation. OpenSSL BN_mod_exp_simple"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "OpenSSL BN_mod_exp_simple"
    created_date     = "2015-05"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { B8 98 02 00 00 E8 ?? ?? ?? ?? 8B 84 24 A4 02 00 00 55 56 33 ED 50 89 6C 24 1C 89 6C 24 18 E8 ?? ?? ?? ?? 8B F0 83 C4 04 3B F5 89 74 24 0C 75 1B 8B 8C 24 A4 02 00 00 6A 01 51 E8 ?? ?? ?? ?? 83 C4 08 5E 5D 81 C4 98 02 00 00 C3 53 57 8B BC 24 BC 02 00 00 57 E8 ?? ?? ?? ?? 57 E8 ?? ?? ?? ?? 8B D8 83 C4 08 3B DD 0F 84 71 02 00 00 8D 54 24 28 52 E8 ?? ?? ?? ?? 8B AC 24 BC 02 00 00 8B 84 24 B4 02 00 00 57 55 8D 4C 24 34 50 51 C7 44 24 30 01 00 00 00 E8 ?? ?? ?? ?? 83 C4 14 85 C0 0F }
  condition:
    $c0
}
// --
rule m99_FGint_RsaSign
{ meta:
    title            = "Crypto Manipulation. FGint RsaSign"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "FGint RsaSign"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 83 C4 B8 53 56 57 89 4D F8 8B FA 89 45 FC 8B 75 0C 8B 5D 10 8B 45 FC E8 ?? ?? ?? ?? 8D 45 F0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 E0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 D8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 D0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 C8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 C0 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8D 45 B8 8B 15 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8D 55 F0 }
  condition:
    $c0
}
// --
rule m100_LockBox_RsaEncryptFile
{ meta:
    title            = "Crypto Manipulation. LockBox RsaEncryptFile"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "LockBox RsaEncryptFile"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 83 C4 F8 53 56 8B F1 8B DA 6A 20 8B C8 B2 01 A1 ?? ?? ?? ?? E8 ?? ?? ?? ?? 89 45 FC 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 68 FF FF 00 00 8B CB B2 01 A1 ?? ?? ?? ?? E8 ?? ?? ?? ?? 89 45 F8 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8A 45 08 50 8B CE 8B 55 F8 8B 45 FC E8 ?? ?? ?? ?? 33 C0 5A 59 59 64 89 10 68 ?? ?? ?? ?? 8B 45 F8 E8 ?? ?? ?? ?? C3 }
  condition:
    $c0
}
// --
rule m101_LockBox_DecryptRsaEx
{ meta:
    title            = "Crypto Manipulation. LockBox DecryptRsaEx"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "LockBox DecryptRsaEx"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 83 C4 F4 53 56 57 89 4D F8 89 55 FC 8B D8 33 C0 8A 43 04 0F B7 34 45 ?? ?? ?? ?? 0F B7 3C 45 ?? ?? ?? ?? 8B CE B2 01 A1 ?? ?? ?? ?? E8 ?? ?? ?? ?? 89 45 F4 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8B 55 FC 8B CE 8B 45 F4 E8 ?? ?? ?? ?? 6A 00 B1 02 8B D3 8B 45 F4 E8 ?? ?? ?? ?? 8B 45 F4 E8 ?? ?? ?? ?? 3B C7 7E 16 B9 ?? ?? ?? ?? B2 01 A1 ?? ?? ?? ?? E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B 45 F4 E8 ?? ?? ?? ?? 8B C8 8B 55 F8 8B 45 F4 E8 ?? ?? ?? ?? 33 C0 5A 59 59 64 89 10 68 }
  condition:
    $c0
}
// --
rule m102_LockBox_EncryptRsaEx
{ meta:
    title            = "Crypto Manipulation. LockBox EncryptRsaEx"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "LockBox EncryptRsaEx"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 83 C4 F8 53 56 57 89 4D FC 8B FA 8B F0 33 C0 8A 46 04 0F B7 1C 45 ?? ?? ?? ?? 8B CB B2 01 A1 ?? ?? ?? ?? E8 ?? ?? ?? ?? 89 45 F8 33 C0 55 68 ?? ?? ?? ?? 64 FF 30 64 89 20 8B D7 8B 4D 08 8B 45 F8 E8 ?? ?? ?? ?? 6A 01 B1 02 8B D6 8B 45 F8 E8 ?? ?? ?? ?? 8B 45 F8 E8 ?? ?? ?? ?? 3B C3 7E 16 B9 ?? ?? ?? ?? B2 01 A1 ?? ?? ?? ?? E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B 45 F8 E8 ?? ?? ?? ?? 8B C8 8B 55 FC 8B 45 F8 E8 ?? ?? ?? ?? 33 C0 5A 59 59 64 89 10 68 ?? ?? ?? ?? 8B 45 F8 E8 }
  condition:
    $c0
}
// --
rule m103_LockBox_TlbRsaKey
{ meta:
    title            = "Crypto Manipulation. LockBox TlbRsaKey"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "LockBox TlbRsaKey"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 53 56 84 D2 74 08 83 C4 F0 E8 ?? ?? ?? ?? 8B DA 8B F0 33 D2 8B C6 E8 ?? ?? ?? ?? 33 C0 8A 46 04 8B 15 ?? ?? ?? ?? 0F B7 0C 42 B2 01 A1 ?? ?? ?? ?? E8 ?? ?? ?? ?? 89 46 0C 33 C0 8A 46 04 8B 15 ?? ?? ?? ?? 0F B7 0C 42 B2 01 A1 ?? ?? ?? ?? E8 ?? ?? ?? ?? 89 46 10 8B C6 84 DB 74 0F E8 ?? ?? ?? ?? 64 8F 05 00 00 00 00 83 C4 0C 8B C6 5E 5B C3 }
  condition:
    $c0
}
// --
rule m104_BigDig_bpInit
{ meta:
    title            = "Crypto Manipulation. BigDig bpInit"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "BigDig bpInit"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 56 8B 74 24 0C 6A 04 56 E8 ?? ?? ?? ?? 8B C8 8B 44 24 10 83 C4 08 85 C9 89 08 75 04 33 C0 5E C3 89 70 08 C7 40 04 00 00 00 00 5E C3 }
  condition:
    $c0
}
// --
rule m105_BigDig_mpModExp
{ meta:
    title            = "Crypto Manipulation. BigDig mpModExp"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "BigDig mpModExp"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 56 8B 74 24 18 85 F6 75 05 83 C8 FF 5E C3 53 55 8B 6C 24 18 57 56 55 E8 ?? ?? ?? ?? 8B D8 83 C4 08 BF 00 00 00 80 8B 44 9D FC 85 C7 75 04 D1 EF 75 F8 83 FF 01 75 08 BF 00 00 00 80 4B EB 02 D1 EF 8B 44 24 18 56 8B 74 24 18 50 56 E8 ?? ?? ?? ?? 83 C4 0C 85 DB 74 4F 8D 6C 9D FC 8B 4C 24 24 8B 54 24 20 51 52 56 56 56 E8 ?? ?? ?? ?? 8B 45 00 83 C4 14 85 C7 74 19 8B 44 24 24 8B 4C 24 20 8B 54 24 18 50 51 52 56 56 E8 ?? ?? ?? ?? 83 C4 14 83 FF 01 75 0B 4B BF 00 00 00 80 83 ED 04 EB }
  condition:
    $c0
}
// --
rule m106_BigDig_mpModInv
{ meta:
    title            = "Crypto Manipulation. BigDig mpModInv"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "BigDig mpModInv"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 81 EC 2C 07 00 00 8D 84 24 CC 00 00 00 53 56 8B B4 24 44 07 00 00 57 56 6A 01 50 E8 ?? ?? ?? ?? 8B 8C 24 4C 07 00 00 56 8D 94 24 80 02 00 00 51 52 E8 ?? ?? ?? ?? 8D 84 24 BC 01 00 00 56 50 E8 ?? ?? ?? ?? 8B 9C 24 64 07 00 00 56 8D 4C 24 30 53 51 E8 ?? ?? ?? ?? 8D 54 24 38 56 52 BF 01 00 00 00 E8 ?? ?? ?? ?? 83 C4 34 85 C0 0F 85 ED 00 00 00 8D 44 24 0C 56 50 8D 8C 24 78 02 00 00 56 8D 94 24 48 03 00 00 51 8D 84 24 18 04 00 00 52 50 E8 ?? ?? ?? ?? 8D 8C 24 BC 01 00 00 56 8D 94 }
  condition:
    $c0
}
// --
rule m107_BigDig_mpModMult
{ meta:
    title            = "Crypto Manipulation. BigDig mpModMult"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "BigDig mpModMult"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 8B 44 24 0C 8B 4C 24 08 81 EC 98 01 00 00 8D 54 24 00 56 8B B4 24 B0 01 00 00 57 56 50 51 52 E8 ?? ?? ?? ?? 8B 84 24 C0 01 00 00 8B 94 24 B4 01 00 00 8D 3C 36 56 50 8D 4C 24 20 57 51 52 E8 ?? ?? ?? ?? 8D 44 24 2C 57 50 E8 ?? ?? ?? ?? 83 C4 2C 33 C0 5F 5E 81 C4 98 01 00 00 C3 }
  condition:
    $c0
}
// --
rule m108_BigDig_mpModulo
{ meta:
    title            = "Crypto Manipulation. BigDig mpModulo"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "BigDig mpModulo"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 8B 44 24 10 81 EC 30 03 00 00 8B 8C 24 38 03 00 00 8D 54 24 00 56 8B B4 24 40 03 00 00 57 8B BC 24 4C 03 00 00 57 50 56 51 8D 84 24 B0 01 00 00 52 50 E8 ?? ?? ?? ?? 8B 94 24 54 03 00 00 8D 4C 24 20 57 51 52 E8 ?? ?? ?? ?? 8D 44 24 2C 56 50 E8 ?? ?? ?? ?? 8D 8C 24 CC 01 00 00 56 51 E8 ?? ?? ?? ?? 83 C4 34 33 C0 5F 5E 81 C4 30 03 00 00 C3 }
  condition:
    $c0
}
// --
rule m109_BigDig_spModExpB
{ meta:
    title            = "Crypto Manipulation. BigDig spModExpB"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "BigDig spModExpB"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 53 8B 5C 24 10 55 56 BE 00 00 00 80 85 F3 75 04 D1 EE 75 F8 8B 6C 24 14 8B C5 D1 EE 89 44 24 18 74 48 57 8B 7C 24 20 EB 04 8B 44 24 1C 57 50 50 8D 44 24 28 50 E8 ?? ?? ?? ?? 83 C4 10 85 F3 74 14 8B 4C 24 1C 57 55 8D 54 24 24 51 52 E8 ?? ?? ?? ?? 83 C4 10 D1 EE 75 D0 8B 44 24 14 8B 4C 24 1C 5F 5E 89 08 5D 33 C0 5B C3 8B 54 24 10 5E 5D 5B 89 02 33 C0 C3 }
  condition:
    $c0
}
// --
rule m110_BigDig_spModInv
{ meta:
    title            = "Crypto Manipulation. BigDig spModInv"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "BigDig spModInv"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 51 8B 4C 24 10 55 56 BD 01 00 00 00 33 F6 57 8B 7C 24 18 89 6C 24 0C 85 C9 74 42 53 8B C7 33 D2 F7 F1 8B C7 8B F9 8B DA 33 D2 F7 F1 8B CB 0F AF C6 03 C5 8B EE 8B F0 8B 44 24 10 F7 D8 85 DB 89 44 24 10 75 D7 85 C0 5B 7D 13 8B 44 24 1C 8B 4C 24 14 2B C5 5F 89 01 5E 33 C0 5D 59 C3 8B 54 24 14 5F 5E 33 C0 89 2A 5D 59 C3 }
  condition:
    $c0
}
// --
rule m111_BigDig_spModMult
{ meta:
    title            = "Crypto Manipulation. BigDig spModMult"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "BigDig spModMult"
    created_date     = "2016-08"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 8B 44 24 0C 8B 4C 24 08 83 EC 08 8D 54 24 00 50 51 52 E8 ?? ?? ?? ?? 8B 44 24 24 6A 02 8D 4C 24 10 50 51 E8 ?? ?? ?? ?? 8B 54 24 24 89 02 33 C0 83 C4 20 C3 }
  condition:
    $c0
}
// --
rule m117_ARIA_SB2
{ meta:
    title            = "Crypto Manipulation. Aria SBox 2"
    author           = "spelissier"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Aria SBox 2"
    created_date     = "2020-12"
    reference        = "http://210.104.33.10/ARIA/doc/ARIA-specification-e.pdf#page=7"
  strings:
    $c0 = { E2 4E 54 FC 94 C2 4A CC 62 0D 6A 46 3C 4D 8B D1 5E FA 64 CB B4 97 BE 2B BC 77 2E 03 D3 19 59 C1 }
  condition:
    $c0
}
// --
rule m118_RijnDael_AES_CHAR_inv
{ meta:
    title            = "Crypto Manipulation. RijnDael AES S-inv [char]"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "RijnDael AES S-inv [char]"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
    //needs improvement
  strings:
    $c0 = { 48 38 47 00 88 17 33 D2 8A 56 0D 8A 92 48 38 47 00 88 57 01 33 D2 8A 56 0A 8A 92 48 38 47 00 88 57 02 33 D2 8A 56 07 8A 92 48 38 47 00 88 57 03 33 D2 8A 56 04 8A 92 }
  condition:
    $c0
}
// --
rule m120_RsaRef2_NN_modInv
{ meta:
    title            = "Crypto Manipulation. RsaRef2 NN_modInv"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "RsaRef2 NN_modInv"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 81 EC A4 04 00 00 53 56 8B B4 24 BC 04 00 00 57 8D 84 24 ?? 00 00 00 56 50 E8 ?? ?? ?? ?? 8D 8C 24 1C 01 00 00 BF 01 00 00 00 56 51 89 BC 24 A0 00 00 00 E8 ?? ?? ?? ?? 8B 94 24 C8 04 00 00 56 8D 84 24 AC 01 00 00 52 50 E8 ?? ?? ?? ?? 8B 9C 24 D8 04 00 00 56 8D 4C 24 2C 53 51 E8 ?? ?? ?? ?? 8D 54 24 34 56 52 E8 ?? ?? ?? ?? 83 C4 30 85 C0 0F 85 ED 00 00 00 8D 44 24 0C 56 50 8D 8C 24 A0 01 00 00 56 8D 94 24 AC 02 00 00 51 8D 84 24 34 03 00 00 52 50 E8 ?? ?? ?? ?? 8D 8C 24 2C 01 }
  condition:
    $c0
}
// --
rule m121_RsaRef2_NN_modMult
{ meta:
    title            = "Crypto Manipulation. RsaRef2 NN_modMul"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "RsaRef2 NN_modMult"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 8B 44 24 0C 8B 4C 24 08 81 EC 08 01 00 00 8D 54 24 00 56 8B B4 24 20 01 00 00 56 50 51 52 E8 ?? ?? ?? ?? 8B 84 24 2C 01 00 00 56 8D 0C 36 50 8B 84 24 28 01 00 00 8D 54 24 1C 51 52 50 E8 ?? ?? ?? ?? 68 08 01 00 00 8D 4C 24 2C 6A 00 51 E8 ?? ?? ?? ?? 83 C4 30 5E 81 C4 08 01 00 00 C3 }
  condition:
    $c0
}
// --
rule m122_RsaRef2_RsaPrivateDecrypt
{ meta:
    title            = "Crypto Manipulation. RsaRef2 RsaPrivateDecrypt"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "RsaRef2 RsaPrivateDecrypt"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 8B 44 24 14 81 EC 84 00 00 00 8B 8C 24 94 00 00 00 56 8B 30 83 C6 07 C1 EE 03 3B CE 76 0D B8 06 04 00 00 5E 81 C4 84 00 00 00 C3 50 8B 84 24 98 00 00 00 51 8D 4C 24 0C 50 8D 54 24 14 51 52 E8 ?? ?? ?? ?? 83 C4 14 85 C0 0F 85 8B 00 00 00 39 74 24 04 74 0D B8 06 04 00 00 5E 81 C4 84 00 00 00 C3 8A 44 24 08 84 C0 75 6B 8A 4C 24 09 B8 02 00 00 00 3A C8 75 5E 8D 4E FF 3B C8 76 0D 8A 54 04 08 84 D2 74 05 40 3B C1 72 F3 40 3B C6 73 45 8B 94 24 ?? 00 00 00 8B CE 2B C8 89 0A 8D 51 0B }
  condition:
    $c0
}
// --
rule m123_RsaRef2_RsaPrivateEncrypt
{ meta:
    title            = "Crypto Manipulation. RsaRef2 RsaPrivateEncrypt"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "RsaRef2 RsaPrivateEncrypt"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 8B 44 24 14 8B 54 24 10 81 EC 80 00 00 00 8D 4A 0B 56 8B 30 83 C6 07 C1 EE 03 3B CE 76 0D B8 06 04 00 00 5E 81 C4 80 00 00 00 C3 8B CE B8 02 00 00 00 2B CA C6 44 24 04 00 49 C6 44 24 05 01 3B C8 76 23 53 55 8D 69 FE 57 8B CD 83 C8 FF 8B D9 8D 7C 24 12 C1 E9 02 F3 AB 8B CB 83 E1 03 F3 AA 8D 45 02 5F 5D 5B 52 8B 94 24 94 00 00 00 C6 44 04 08 00 8D 44 04 09 52 50 E8 ?? ?? ?? ?? 8B 8C 24 A4 00 00 00 8B 84 24 98 00 00 00 51 8B 8C 24 98 00 00 00 8D 54 24 14 56 52 50 51 E8 }
  condition:
    $c0
}
// --
rule m124_RsaRef2_RsaPublicDecrypt
{ meta:
    title            = "Crypto Manipulation. RsaRef2 RsaPublicDecrypt"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "RsaRef2 RsaPublicDecrypt"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 8B 44 24 14 81 EC 84 00 00 00 8B 8C 24 94 00 00 00 56 8B 30 83 C6 07 C1 EE 03 3B CE 76 0D B8 06 04 00 00 5E 81 C4 84 00 00 00 C3 50 8B 84 24 98 00 00 00 51 8D 4C 24 0C 50 8D 54 24 14 51 52 E8 ?? ?? ?? ?? 83 C4 14 85 C0 0F 85 8E 00 00 00 39 74 24 04 74 0D B8 06 04 00 00 5E 81 C4 84 00 00 00 C3 8A 44 24 08 84 C0 75 6E 80 7C 24 09 01 75 67 B8 02 00 00 00 8D 4E FF 3B C8 76 0D B2 FF 38 54 04 08 75 05 40 3B C1 72 F5 8A 4C 04 08 40 84 C9 75 45 8B 94 24 ?? 00 00 00 8B CE 2B C8 89 0A }
  condition:
    $c0
}
// --
rule m125_RsaRef2_RsaPublicEncrypt
{ meta:
    title            = "Crypto Manipulation. RsaRef2 RsaPublicEncrypt"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "RsaRef2 RsaPublicEncrypt"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 8B 44 24 14 81 EC 84 00 00 00 53 8B 9C 24 98 00 00 00 57 8B 38 83 C7 07 8D 4B 0B C1 EF 03 3B CF 76 0E 5F B8 06 04 00 00 5B 81 C4 84 00 00 00 C3 8B D7 55 2B D3 56 BE 02 00 00 00 C6 44 24 14 00 8D 6A FF C6 44 24 15 02 3B EE 76 28 8B 84 24 AC 00 00 00 8D 4C 24 13 50 6A 01 51 E8 ?? ?? ?? ?? 8A 44 24 1F 83 C4 0C 84 C0 74 E1 88 44 34 14 46 3B F5 72 D8 8B 94 24 A0 00 00 00 53 8D 44 34 19 52 50 C6 44 34 20 00 E8 ?? ?? ?? ?? 8B 8C 24 B4 00 00 00 8B 84 24 A8 00 00 00 51 8B 8C 24 A8 00 }
  condition:
    $c0
}
// --
rule m126_RsaEuro_NN_modInv
{ meta:
    title            = "Crypto Manipulation. RsaEuro NN_modInv"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "RsaEuro NN_modInv"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 81 EC A4 04 00 00 53 56 8B B4 24 BC 04 00 00 57 8D 44 24 0C 56 50 E8 ?? ?? ?? ?? 8D 8C 24 1C 01 00 00 BF 01 00 00 00 56 51 89 7C 24 1C E8 ?? ?? ?? ?? 8B 94 24 C8 04 00 00 56 8D 84 24 AC 01 00 00 52 50 E8 ?? ?? ?? ?? 8B 9C 24 D8 04 00 00 56 8D 8C 24 B0 00 00 00 53 51 E8 ?? ?? ?? ?? 8D 94 24 B8 00 00 00 56 52 E8 ?? ?? ?? ?? 83 C4 30 85 C0 0F 85 F8 00 00 00 8D 84 24 ?? 00 00 00 56 50 8D 8C 24 A0 01 00 00 56 8D 94 24 AC 02 00 00 51 8D 84 24 34 03 00 00 52 50 E8 ?? ?? ?? ?? 8D 8C }
  condition:
    $c0
}
// --
rule m127_RsaEuro_NN_modMult
{ meta:
    title            = "Crypto Manipulation. RsaEuro NN_modMult"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "RsaEuro NN_modMult"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 8B 44 24 0C 8B 4C 24 08 81 EC 08 01 00 00 8D 54 24 00 56 8B B4 24 20 01 00 00 56 50 51 52 E8 ?? ?? ?? ?? 8B 84 24 2C 01 00 00 56 8D 0C 36 50 8B 84 24 28 01 00 00 8D 54 24 1C 51 52 50 E8 ?? ?? ?? ?? 83 C4 24 5E 81 C4 08 01 00 00 C3 }
  condition:
    $c0
}
// --
rule m128_Miracl_Big_constructor
{ meta:
    title            = "Crypto Manipulation. Miracl Big constructor"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Miracl Big constructor"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 56 8B F1 6A 00 E8 ?? ?? ?? ?? 83 C4 04 89 06 8B C6 5E C3 }
  condition:
    $c0
}
// --
rule m129_Miracl_mirvar
{ meta:
    title            = "Crypto Manipulation. Miracl mirvar"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Miracl mirvar"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 56 E8 ?? ?? ?? ?? 8B 88 18 02 00 00 85 C9 74 04 33 C0 5E C3 8B 88 8C 00 00 00 85 C9 75 0E 6A 12 E8 ?? ?? ?? ?? 83 C4 04 33 C0 5E C3 8B 80 38 02 00 00 6A 01 50 E8 ?? ?? ?? ?? 8B F0 83 C4 08 85 F6 75 02 5E C3 8D 46 04 8B C8 8B D0 83 E1 03 2B D1 83 C2 08 89 10 8B 44 24 08 85 C0 74 0A 56 50 E8 ?? ?? ?? ?? 83 C4 08 8B C6 5E C3 }
    $c1 = { 56 57 E8 ?? ?? ?? ?? 8B F0 8B 86 2C 02 00 00 85 C0 74 05 5F 33 C0 5E C3 8B 56 1C 42 8B C2 89 56 1C 83 F8 18 7D 17 C7 44 86 20 17 00 00 00 8B 86 40 02 00 00 85 C0 74 05 E8 ?? ?? ?? ?? 8B 86 8C 00 00 00 85 C0 75 16 6A 12 E8 ?? ?? ?? ?? 8B 46 1C 83 C4 04 48 89 46 1C 5F 33 C0 5E C3 8B 46 18 6A 01 8D 0C 85 0C 00 00 00 51 E8 ?? ?? ?? ?? 8B F8 83 C4 08 85 FF 75 0C 8B 46 1C 5F 48 89 46 1C 33 C0 5E C3 8D 47 04 8B D0 8B C8 83 E2 03 2B CA 83 C1 08 89 08 8B 44 24 0C 85 C0 74 0A 57 50 E8 }
    $c2 = { 56 57 E8 ?? ?? ?? ?? 8B F0 8B 86 18 02 00 00 85 C0 74 05 5F 33 C0 5E C3 8B 56 1C 42 8B C2 89 56 1C 83 F8 18 7D 17 C7 44 86 20 17 00 00 00 8B 86 2C 02 00 00 85 C0 74 05 E8 ?? ?? ?? ?? 8B 86 8C 00 00 00 85 C0 75 16 6A 12 E8 ?? ?? ?? ?? 8B 46 1C 83 C4 04 48 89 46 1C 5F 33 C0 5E C3 8B 86 A4 02 00 00 6A 01 50 E8 ?? ?? ?? ?? 8B F8 83 C4 08 85 FF 75 0C 8B 46 1C 5F 48 89 46 1C 33 C0 5E C3 8D 47 04 8B C8 8B D0 83 E1 03 2B D1 83 C2 08 89 10 8B 44 24 0C 85 C0 74 0A 57 50 E8 }
  condition:
    any of them
}
// --
rule m130_Miracl_mirsys_init
{ meta:
    title            = "Crypto Manipulation. Miracl mirsys init"
    author           = "Maxx"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Miracl mirsys init"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 53 55 57 E8 ?? ?? ?? ?? A3 ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 DB A3 ?? ?? ?? ?? 3B C3 75 06 5F 5D 33 C0 5B C3 89 58 1C A1 ?? ?? ?? ?? BD 01 00 00 00 89 58 20 A1 ?? ?? ?? ?? 8B 50 1C 42 89 50 1C A1 ?? ?? ?? ?? 8B 48 1C C7 44 88 20 1D 00 00 00 8B 15 ?? ?? ?? ?? 89 9A 14 02 00 00 A1 ?? ?? ?? ?? 89 98 70 01 00 00 8B 0D ?? ?? ?? ?? 89 99 78 01 00 00 8B 15 ?? ?? ?? ?? 89 9A 98 01 00 00 A1 ?? ?? ?? ?? 89 58 14 8B 44 24 14 3B C5 0F 84 6C 05 00 00 3D 00 00 00 80 0F 87 61 05 00 00 50 E8 }
  condition:
    $c0
}
// --
rule m140_Unknown_Random {
  meta:
    title            = "Crypto Manipulation. Random function"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Look for Random function"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 52 8B 45 08 69 15 ?? ?? ?? ?? 05 84 08 08 42 89 15 ?? ?? ?? ?? F7 E2 8B C2 5A C9 C2 04 00 }
  condition:
    $c0
}
// --
rule m143_DCP_RIJNDAEL_Init {
  meta:
    title            = "Crypto Manipulation. DCP RijnDael Init"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Look for DCP RijnDael Init"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 51 53 56 57 89 4D FC 8B FA 8B D8 8B 75 08 56 8B D7 8B 4D FC 8B C3 E8 ?? ?? ?? ?? 8B D7 8B 4D FC 8B C3 8B 38 FF 57 ?? 85 F6 75 25 8D 43 38 33 C9 BA 10 00 00 00 E8 ?? ?? ?? ?? 8D 4B 38 8D 53 38 8B C3 8B 30 FF 56 ?? 8B C3 8B 10 FF 52 ?? EB 16 8D 53 38 8B C6 B9 10 00 00 00 E8 ?? ?? ?? ?? 8B C3 8B 10 FF 52 ?? 5F 5E 5B 59 5D C2 04 00 }
  condition:
    $c0
}
// --
rule m144_DCP_RIJNDAEL_EncryptECB {
  meta:
    title            = "Crypto Manipulation. DCP RijnDael EncryptECB"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Look for DCP RijnDael EncryptECB"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 53 56 57 55 83 C4 B4 89 0C 24 8D 74 24 08 8D 7C 24 28 80 78 30 00 75 16 B9 ?? ?? ?? ?? B2 01 A1 ?? ?? ?? ?? E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B 0A 89 0F 8B CA 83 C1 04 8B 09 8D 5F 04 89 0B 8B CA 83 C1 08 8B 09 8D 5F 08 89 0B 83 C2 0C 8B 12 8D 4F 0C 89 11 8B 50 58 83 EA 02 85 D2 0F 82 3B 01 00 00 42 89 54 24 04 33 D2 8B 0F 8B DA C1 E3 02 33 4C D8 5C 89 0E 8D 4F 04 8B 09 33 4C D8 60 8D 6E 04 89 4D 00 8D 4F 08 8B 09 33 4C D8 64 8D 6E 08 89 4D 00 8D 4F 0C 8B 09 33 4C D8 68 8D 5E 0C 89 0B 33 C9 8A 0E 8D 0C 8D }
  condition:
    $c0
}
// --
rule m145_DCP_BLOWFISH_Init {
  meta:
    title            = "Crypto Manipulation. DCP Blowfish Init"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Look for DCP Blowfish Init"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 53 56 57 55 8B F2 8B F8 8B CF B2 01 A1 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B D8 8B C3 8B 10 FF 52 34 8B C6 E8 ?? ?? ?? ?? 50 8B C6 E8 ?? ?? ?? ?? 8B D0 8B C3 59 8B 30 FF 56 3C 8B 43 3C 85 C0 79 03 83 C0 07 C1 F8 03 E8 ?? ?? ?? ?? 8B F0 8B D6 8B C3 8B 08 FF 51 40 8B 47 40 8B 6B 3C 3B C5 7D 0F 6A 00 8B C8 8B D6 8B C7 8B 38 FF 57 30 EB 0D 6A 00 8B D6 8B CD 8B C7 8B 38 FF 57 30 8B 53 3C 85 D2 79 03 83 C2 07 C1 FA 03 8B C6 B9 FF 00 00 00 E8 ?? ?? ?? ?? 8B 53 3C 85 D2 79 03 83 C2 07 C1 FA 03 8B C6 E8 ?? ?? ?? ?? 8B C3 E8 ?? ?? ?? ?? 5D 5F 5E 5B C3 }
  condition:
    $c0
}
// --
rule m146_DCP_BLOWFISH_EncryptCBC {
  meta:
    title            = "Crypto Manipulation. DCP Blowfish EncryptCBC"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Look for DCP Blowfish EncryptCBC"
    created_date     = "2016-07"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 83 C4 F0 53 56 57 89 4D F8 89 55 FC 8B D8 80 7B 34 00 75 16 B9 ?? ?? ?? ?? B2 01 A1 ?? ?? ?? ?? E8 ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B 7D 08 85 FF 79 03 83 C7 07 C1 FF 03 85 FF 7E 56 BE 01 00 00 00 6A 08 8B 45 FC 8B D6 4A C1 E2 03 03 C2 8D 4D F0 8D 53 54 E8 ?? ?? ?? ?? 8D 4D F0 8D 55 F0 8B C3 E8 ?? ?? ?? ?? 8B 55 F8 8B C6 48 C1 E0 03 03 D0 8D 45 F0 B9 08 00 00 00 E8 ?? ?? ?? ?? 8D 53 54 8D 45 F0 B9 08 00 00 00 E8 ?? ?? ?? ?? 46 4F 75 AF 8B 75 08 81 E6 07 00 00 80 79 05 4E 83 CE F8 46 85 F6 74 26 8D 4D F0 8D 53 54 8B C3 E8 ?? ?? ?? ?? 56 8B 4D F8 03 4D 08 2B CE 8B 55 FC 03 55 08 2B D6 8D 45 F0 E8 ?? ?? ?? ?? 8D 45 F0 B9 FF 00 00 00 BA 08 00 00 00 E8 ?? ?? ?? ?? 5F 5E 5B 8B E5 5D C2 04 00 }
  condition:
    $c0
}
// --
rule m147_DCP_DES_Init {
  meta:
    title            = "Crypto Manipulation. DCP Des Init"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Look for DCP Des Init"
    created_date     = "2016-02"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 55 8B EC 51 53 56 57 89 4D FC 8B FA 8B D8 8B 75 08 56 8B D7 8B 4D FC 8B C3 E8 FE F9 FF FF 8B D7 8B 4D FC 8B C3 8B 38 FF 57 5C 85 F6 75 25 8D 43 38 33 C9 BA 08 00 00 00 E8 F3 A9 FA FF 8D 4B 38 8D 53 38 8B C3 8B 30 FF 56 6C 8B C3 8B 10 FF 52 48 EB 16 8D 53 38 8B C6 B9 08 00 00 00 E8 6E A7 FA FF 8B C3 8B 10 FF 52 48 5F 5E 5B 59 5D C2 04 00 }
    $c1 = { 55 8B EC 51 53 56 57 89 4D FC 8B FA 8B D8 8B 75 08 56 8B D7 8B 4D FC 8B C3 E8 EE D4 FF FF 8B D7 8B 4D FC 8B C3 8B 38 FF 57 74 85 F6 75 2B 8D 43 40 B9 FF 00 00 00 BA 08 00 00 00 E8 ?? ?? ?? ?? 8D 4B 40 8D 53 40 8B C3 8B 30 FF 96 84 00 00 00 8B C3 8B 10 FF 52 58 EB 16 8D 53 40 8B C6 B9 08 00 00 00 E8 ?? ?? ?? ?? 8B C3 8B 10 FF 52 58 5F 5E 5B 59 5D C2 04 00 }
  condition:
    any of them
}
// --
rule m148_DCP_DES_EncryptECB {
  meta:
    title            = "Crypto Manipulation. DCP Des EncryptECB"
    author           = "_pusher_"
    source           = "https://github.com/Yara-Rules/rules/blob/master/crypto/crypto_signatures.yar"
    description      = "Look for DCP Des EncryptECB"
    created_date     = "2016-02"
    reference        = "https://www.iso.org/standard/54796.html"
  strings:
    $c0 = { 53 80 78 ?? 00 75 16 B9 ?? ?? ?? 00 B2 01 A1 ?? ?? ?? 00 E8 ?? ?? ?? FF E8 ?? ?? ?? FF 8D 58 ?? 53 E8 ?? ?? FF FF 5B C3 }
  condition:
    any of them
}